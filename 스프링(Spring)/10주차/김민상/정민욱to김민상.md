## 📌 CS 스터디 피드백 (2025-04-16)

### 1. 답변하지 못한 질문 📝

#### ✅ JPA에서도 내부적으로 Proxy Pattern이 사용되는데 어디서 사용되는지 아시나요?
Lazy Loading을 위해 사용됩니다. Proxy Pattern에 대해 설명하실 때, Lazy Loading을 언급하셔서 여쭤봤습니다.

#### ✅ N+1문제의 해결법으로 batch_size를 언급하셨고 batch_size해결법의 단점으로 size를 정하기 어렵다고 하셨는데, batch_size를 무작정 크게 만들면 어떤 문제가 생기나요?
저는 IN절에서 오는 과부하를 생각하고 여쭤보긴 했습니다.
IN절은 Optimizer가 어떻게 최적화해주냐에 따라 달라질 수는 있지만 대부분의 경우 INDEX를 N번 탐색해야합니다.
ex IN (A,B,C);면 인덱스를 루트부터 리프까지 타고가는 행위를 3번 해야합니다.

IN절에 수백개가 들어가면 수백번 탐색하겠죠. 
DB마다 다르긴 하지만 IN절에 너무 많은 요소가 들어가지 못하도록 막아놓은게 디폴트 설정으로 되어있기도 합니다.
(정확히는 MySQL기준으로 IN절 사용할 때, 임시 테이블 용량에 제한이 걸려있는거긴 합니다.)

#### ✅ CS에서 쓰기 지연을 통해 성능을 개선하는 다른 사례를 알고계신게 있나요?
힌트로 MySQL의 Buffer Pool을 말씀드렸습니다.

> BufferPool이 이제 디스크에서 조회했던 것들을 BufferPool이라는 캐시에다 저장을 하거나 아니면 인덱스에서 조회했던 Query들도 해당 BufferPool에 저장을 하고 요청이 들어왔을 때 버퍼 풀을 먼저 확인해서 있다면 그때 반환해 주는 역할을 하고 있는 걸로 알고 있습니다.

쓰기 지연은 디스크 접근 횟수를 낮추기 위해 모아서 한번에 쓰는 방식을 말합니다.
(가장 흔한게 디스크긴 하지만 메모리 계층구조에서 상위 계층에 모아놨다가 하위 계층에 한번에 보내는 사례는 다 해당될 것 같네요)

쓰기 지연은 부차적으로 읽기 성능을 올려주기도 하지만 핵심은 모아서 한번에 써서 디스크 접근 횟수를 낮추고 이를 통해 성능이 개선되는 테크닉이라 생각합니다. Buffer Pool의 읽기 성능 개선 사례만 말씀해주셨기에 올바른 답변이 아니라고 생각합니다.

쓰기 지연이 사용되는 다른 사례로는 아래 내용들 정도가 떠오르네요.
1. CPU cache line에 의한 쓰기 성능 향상 (cpu cache -> main memory로 쓰기지연)
2. OS의 Page Cache (main memory -> DISK로의 쓰기 지연)

모의 면접 과정에서 다룬거긴 하지만 아래 내용들도 있죠.
1. JPA Persistence Context (main memory -> Network, DB로의 쓰기 지연)
2. Write Back 전략 (In memory DB -> Network, DB로의 쓰기 지연)

### 2. 좋았던 점 ✨
- Bean에 대해 언급하시면서 AOP, @Transactional과 같은 키워드를 의도적으로 흘리신거같아요. 결과적으로 잘 알고 계신 주제로 꼬리 질문이 흘러가게 됐습니다.

### 3. 보완하면 좋을 점 💡
- 최소 책임 원칙에서 "책임"은 주관적일 수 있을거 같아요. 민상님은 "책임"을 나누는 기준이 있으신가요? 질문에서 두괄식으로 답변하는게 더 좋았을 거 같습니다.